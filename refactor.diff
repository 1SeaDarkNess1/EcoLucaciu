<<<<<<< SEARCH
let cachedViews = [];
let viewsMap = {};
let mathJaxPromise = null;
=======
let cachedViews = [];
let viewsMap = {};
let isViewCacheInitialized = false;

function initViewCache() {
    if (isViewCacheInitialized) return;
    cachedViews = Array.from(document.querySelectorAll(".view"));
    cachedViews.forEach(v => { if (v.id) viewsMap[v.id] = v; });
    isViewCacheInitialized = true;
}

let mathJaxPromise = null;
>>>>>>> REPLACE
<<<<<<< SEARCH
function showPage(id, saveHistory = true) {
    if (!id) return;

    if (saveHistory && history.state && history.state.pageId === id) {
        return;
    }

    // Lazy initialization if called before 'load' event
    if (cachedViews.length === 0) {
        cachedViews = Array.from(document.querySelectorAll(".view"));
        cachedViews.forEach(v => { if (v.id) viewsMap[v.id] = v; });
    }

    cachedViews.forEach(v => v.classList.remove("active"));
=======
function showPage(id, saveHistory = true) {
    if (!id) return;

    if (saveHistory && history.state && history.state.pageId === id) {
        return;
    }

    // Lazy initialization if called before 'load' event
    initViewCache();

    cachedViews.forEach(v => v.classList.remove("active"));
>>>>>>> REPLACE
<<<<<<< SEARCH
window.addEventListener('load', async () => {
    // Populate views cache
    cachedViews = Array.from(document.querySelectorAll(".view"));
    cachedViews.forEach(v => { if (v.id) viewsMap[v.id] = v; });

    await initData();
=======
window.addEventListener('load', async () => {
    // Populate views cache
    initViewCache();

    await initData();
>>>>>>> REPLACE
