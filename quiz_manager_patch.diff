<<<<<<< SEARCH
    start(type = "general") {
        this.type = type;
        let bank = [...masterBank];
        if(type === 'micro') bank = bank.filter((_, i) => i % 2 === 0);
        if(type === 'macro') bank = bank.filter((_, i) => i % 2 !== 0);
        if (bank.length < 5) bank = [...masterBank];

        this.questions = bank.sort(() => 0.5 - Math.random()).slice(0, 20);

        // Resetare stare
        const timerEl = document.getElementById("timer");
        this.index = 0; this.score = 0; this.secs = 0; this.correct = 0; this.wrong = 0;
        document.getElementById('correct-count').innerText = 0;
        document.getElementById('wrong-count').innerText = 0;
        timerEl.innerText = "00:00";

        showPage('quiz');

        // Timer
        if (this.timer) clearInterval(this.timer);
        this.timer = setInterval(() => {
            this.secs++;
            const min = Math.floor(this.secs / 60);
            const sec = this.secs % 60;
            timerEl.innerText = `${min < 10 ? '0'+min : min}:${sec < 10 ? '0'+sec : sec}`;
        }, 1000);

        this.render();
    },

    render() {
        const d = this.questions[this.index];
        const qText = document.getElementById('q-text');
        qText.innerText = d.q;
        document.getElementById('q-counter').innerText = `${this.index + 1} / ${this.questions.length}`;
        document.getElementById('progress-bar').style.width = `${((this.index + 1) / this.questions.length) * 100}%`;
        const box = document.getElementById('options-box'); box.innerHTML = '';
        d.o.forEach((opt, i) => {
            const btn = document.createElement('button'); btn.className = 'opt-btn'; btn.innerText = opt; btn.dataset.index = i;
            box.appendChild(btn);
        });
    },

    handleAnswer(i) {
        const d = this.questions[this.index];
        const overlay = document.getElementById('quiz-feedback-overlay');
        overlay.classList.remove('hidden');

        if (i === d.c) {
            this.score += 5; this.correct++;
            overlay.innerText = "CORECT!"; overlay.className = "feedback-overlay correct-overlay";
            document.getElementById('correct-count').innerText = this.correct;
        } else {
            this.wrong++;
            overlay.innerText = "GREȘIT!"; overlay.className = "feedback-overlay wrong-overlay";
            document.getElementById('wrong-count').innerText = this.wrong;
        }
        setTimeout(() => {
            overlay.classList.add('hidden');
            this.index++;
            if (this.index < this.questions.length) this.render(); else this.finish();
        }, 700);
    },

    finish() {
        clearInterval(this.timer);
        showPage('results');
        document.getElementById('final-score').innerText = this.score;
        document.getElementById('final-time').innerText = document.getElementById('timer').innerText;
        document.getElementById('final-grade').innerText = (this.score / 10).toFixed(1);
        document.getElementById('performance-msg').innerText = this.score >= 85 ? "Excelent! Pregătit de succes." : "Continuă studiul pentru rezultate mai bune.";
    }
=======
    initElements() {
        if (this.timerEl) return;
        this.timerEl = document.getElementById('timer');
        this.correctEl = document.getElementById('correct-count');
        this.wrongEl = document.getElementById('wrong-count');
        this.qTextEl = document.getElementById('q-text');
        this.qCounterEl = document.getElementById('q-counter');
        this.progressEl = document.getElementById('progress-bar');
        this.optionsBoxEl = document.getElementById('options-box');
        this.feedbackEl = document.getElementById('quiz-feedback-overlay');
    },

    start(type = "general") {
        this.initElements();
        this.type = type;
        let bank = [...masterBank];
        if(type === 'micro') bank = bank.filter((_, i) => i % 2 === 0);
        if(type === 'macro') bank = bank.filter((_, i) => i % 2 !== 0);
        if (bank.length < 5) bank = [...masterBank];

        this.questions = bank.sort(() => 0.5 - Math.random()).slice(0, 20);

        // Resetare stare
        this.index = 0; this.score = 0; this.secs = 0; this.correct = 0; this.wrong = 0;
        this.correctEl.innerText = 0;
        this.wrongEl.innerText = 0;
        this.timerEl.innerText = "00:00";

        showPage('quiz');

        // Timer
        if (this.timer) clearInterval(this.timer);
        this.timer = setInterval(() => {
            this.secs++;
            const min = Math.floor(this.secs / 60);
            const sec = this.secs % 60;
            this.timerEl.innerText = `${min < 10 ? '0'+min : min}:${sec < 10 ? '0'+sec : sec}`;
        }, 1000);

        this.render();
    },

    render() {
        this.initElements();
        const d = this.questions[this.index];
        this.qTextEl.innerText = d.q;
        this.qCounterEl.innerText = `${this.index + 1} / ${this.questions.length}`;
        this.progressEl.style.width = `${((this.index + 1) / this.questions.length) * 100}%`;
        this.optionsBoxEl.innerHTML = '';
        d.o.forEach((opt, i) => {
            const btn = document.createElement('button'); btn.className = 'opt-btn'; btn.innerText = opt; btn.dataset.index = i;
            this.optionsBoxEl.appendChild(btn);
        });
    },

    handleAnswer(i) {
        this.initElements();
        const d = this.questions[this.index];
        const overlay = this.feedbackEl;
        overlay.classList.remove('hidden');

        if (i === d.c) {
            this.score += 5; this.correct++;
            overlay.innerText = "CORECT!"; overlay.className = "feedback-overlay correct-overlay";
            this.correctEl.innerText = this.correct;
        } else {
            this.wrong++;
            overlay.innerText = "GREȘIT!"; overlay.className = "feedback-overlay wrong-overlay";
            this.wrongEl.innerText = this.wrong;
        }
        setTimeout(() => {
            overlay.classList.add('hidden');
            this.index++;
            if (this.index < this.questions.length) this.render(); else this.finish();
        }, 700);
    },

    finish() {
        this.initElements();
        clearInterval(this.timer);
        showPage('results');
        document.getElementById('final-score').innerText = this.score;
        document.getElementById('final-time').innerText = this.timerEl.innerText;
        document.getElementById('final-grade').innerText = (this.score / 10).toFixed(1);
        document.getElementById('performance-msg').innerText = this.score >= 85 ? "Excelent! Pregătit de succes." : "Continuă studiul pentru rezultate mai bune.";
    }
>>>>>>> REPLACE
